<?php
/*
 * Created on 13-Feb-2006
 *
 * Link Handler for URL/query string generated by Link Generator
 * e.g.
 * $linkHandler = new LinkHandler($PHP_SELF, $_POST, $_GET); 
 */
if (!class_exists(URLEncoding)){
	require "URLEncoding.phtml";
}

// change of constant should change the LinkGenerator.phtml
define("QUERY_KEY_LINK_AFTER_DONE", 			"urlwhendone");
define("QUERY_KEY_JS_AFTER_DONE", 				"jswhendone");
define("QUERY_KEY_BACK_AFTER_DONE",				"backwhendone");
 
 class LinkHandler{
 	var $self;
 	var $postArray;
 	var $getArray;
 	
 	function LinkHandler($self, $postArray, $getArray){
 		$this->self = $self;
 		$this->postArray = $postArray;
 		$this->getArray = $getArray;	
 	}
 	
 	/**
 	 * Get javascript action 
 	 */
 	function getJavascriptAction(){
 		$js = "";
 		if ($this->getArray[QUERY_KEY_JS_AFTER_DONE] != ""){
 			$js = 	$this->getArray[QUERY_KEY_JS_AFTER_DONE];
 		} else if ($this->postArray[QUERY_KEY_JS_AFTER_DONE] != ""){
 			$js = 	$this->postArray[QUERY_KEY_JS_AFTER_DONE];
 		}  
 		$urlEncoding = new URLEncoding();
 		$js = $urlEncoding->decodeURL($js);
 		return $js;
 		
 	}
 		
 	/**
 	 * Get forward link
 	 */
 	function getForwardLink(){
 		$link = "";
 		if ($this->getArray[QUERY_KEY_LINK_AFTER_DONE] != ""){
 			$link = 	$this->getArray[QUERY_KEY_LINK_AFTER_DONE];
 		} else if ($this->postArray[QUERY_KEY_LINK_AFTER_DONE] != ""){
 			$link = 	$this->postArray[QUERY_KEY_LINK_AFTER_DONE];
 		}  
 		$urlEncoding = new URLEncoding();
 		$link = $urlEncoding->decodeURL($link);
 		return $link;
 		
 	} 	
 	
 	/**
 	 * Get number of back level
 	 */
 	function getBackLevel(){
 		$back = -1;
 		if ($this->getArray[QUERY_KEY_BACK_AFTER_DONE] != ""){
 			$back = 	$this->getArray[QUERY_KEY_BACK_AFTER_DONE];
 		} else if ($this->postArray[QUERY_KEY_BACK_AFTER_DONE] != ""){
 			$back = 	$this->postArray[QUERY_KEY_BACK_AFTER_DONE];
 		}  
 		return $back;
 		
 	}
 } // LinkHandler
?>
